# üöÄ ZettiBot

**Assistente Digital de Vendas para Telegram**

*Transforme caos em estrat√©gia e potencialize seus resultados comerciais*

![Next.js](https://img.shields.io/badge/Next.js-14.0.2-black?style=flat-square&logo=next.js)
![TypeScript](https://img.shields.io/badge/TypeScript-5.2.2-blue?style=flat-square&logo=typescript)
![Supabase](https://img.shields.io/badge/Supabase-Latest-green?style=flat-square&logo=supabase)
![Telegram](https://img.shields.io/badge/Telegram-Bot_API-blue?style=flat-square&logo=telegram)
![Vercel](https://img.shields.io/badge/Vercel-Deployed-black?style=flat-square&logo=vercel)
![Version](https://img.shields.io/badge/Version-1.0.0-green?style=flat-square)
![Status](https://img.shields.io/badge/Status-Production_Ready-brightgreen?style=flat-square)
![Uptime](https://img.shields.io/badge/Uptime-99.9%25-brightgreen?style=flat-square)

---

## üìã Sobre o Projeto

ZettiBot √© um assistente digital inovador desenvolvido especificamente para vendedores externos. Atrav√©s do Telegram, oferece uma suite completa de ferramentas para gest√£o de clientes, agenda e sistema de notifica√ß√µes autom√°ticas.

### üéØ **Funcionalidades Implementadas (v1.0.0)**

- üë• **Gest√£o Completa de Clientes** - CRUD com valida√ß√µes robustas e busca avan√ßada
- üìÖ **Agenda Inteligente** - Compromissos com pagina√ß√£o e edi√ß√£o completa
- üîî **Sistema de Notifica√ß√µes** - Lembretes autom√°ticos de 15min a 24h antes
- ‚è∞ **Fuso Hor√°rio Brasileiro** - Gest√£o correta de hor√°rios UTC-3
- üîç **Busca Avan√ßada** - Por nome, CNPJ ou contato
- üì± **Interface Conversacional** - Intera√ß√£o natural via Telegram

### ‚ú® **Diferenciais T√©cnicos**

- **Arquitetura Modular** - C√≥digo limpo, escal√°vel e bem estruturado
- **TypeScript Rigoroso** - Tipagem forte e valida√ß√µes robustas
- **Multi-etapas Inteligente** - Conversas que guiam o usu√°rio naturalmente  
- **Cache Otimizado** - Performance melhorada com cache de usu√°rios
- **Rate Limiting** - Prote√ß√£o contra spam e uso excessivo
- **Logs de Auditoria** - Rastreamento completo de a√ß√µes

---

## üéØ **STATUS ATUAL (v1.0.0)**

### ‚úÖ **FUNCIONALIDADES COMPLETAS (100%)**

#### **üèóÔ∏è Sistema Base**
- ‚úÖ Cadastro/autentica√ß√£o de usu√°rios
- ‚úÖ Menu principal naveg√°vel
- ‚úÖ Sistema de cancelamento universal
- ‚úÖ Middleware de autentica√ß√£o robusto
- ‚úÖ Cache de usu√°rios para performance

#### **üë• Gest√£o de Clientes**
- ‚úÖ CRUD completo (criar, listar, editar, excluir)
- ‚úÖ Valida√ß√µes robustas (CNPJ real, telefone, email)
- ‚úÖ Busca avan√ßada (nome, CNPJ, contato)
- ‚úÖ Pagina√ß√£o autom√°tica inteligente
- ‚úÖ Formata√ß√£o de dados brasileira
- ‚úÖ Sanitiza√ß√£o e limpeza de inputs

#### **üìÖ Gest√£o de Agenda**
- ‚úÖ Criar compromissos (com/sem cliente vinculado)
- ‚úÖ Editar compromissos existentes
- ‚úÖ Listar com pagina√ß√£o inteligente
- ‚úÖ Concluir/cancelar compromissos
- ‚úÖ Busca e vincula√ß√£o de clientes
- ‚úÖ Valida√ß√£o de datas/hor√°rios futuro

#### **üîî Sistema de Notifica√ß√µes**
- ‚úÖ Lembretes personaliz√°veis (15min, 30min, 1h, 5h, 12h, 24h)
- ‚úÖ Processamento autom√°tico via cron-job externo
- ‚úÖ Retry autom√°tico com at√© 3 tentativas
- ‚úÖ Limpeza autom√°tica de notifica√ß√µes antigas
- ‚úÖ Gest√£o correta de fuso hor√°rio brasileiro

#### **üõ°Ô∏è Seguran√ßa e Performance**
- ‚úÖ Rate limiting para prevenir spam
- ‚úÖ Timeouts em opera√ß√µes de banco
- ‚úÖ Valida√ß√£o rigorosa de inputs
- ‚úÖ Logs de auditoria detalhados
- ‚úÖ Tratamento robusto de erros

### üöß **PLANEJADO PARA PR√ìXIMAS VERS√ïES**
- üîÑ **Follow-up de Leads** - Sistema de acompanhamento de negocia√ß√µes
- üìù **Lembretes Customizados** - Al√©m de compromissos de agenda
- üìä **Relat√≥rios e Analytics** - M√©tricas de vendas e performance
- üó∫Ô∏è **Rotas Otimizadas** - Planejamento inteligente de visitas
- üåê **Dashboard Web** - Interface administrativa

---

## üõ†Ô∏è Stack Tecnol√≥gica

| Tecnologia | Vers√£o | Prop√≥sito |
|------------|--------|-----------|
| **Next.js** | 14.0.2 | Framework React para API |
| **TypeScript** | 5.2.2 | Tipagem est√°tica rigorosa |
| **Supabase** | Latest | Banco PostgreSQL + Auth |
| **Telegraf** | 4.15.0 | SDK Telegram Bot API |
| **Vercel** | - | Deploy e hospedagem |
| **date-fns** | 2.30.0 | Manipula√ß√£o de datas com locale PT-BR |
| **Zod** | 3.22.4 | Valida√ß√£o de schemas |

---

## üöÄ In√≠cio R√°pido

### üìã **Pr√©-requisitos**

- Node.js 18+ 
- npm ou yarn
- Conta no Supabase
- Bot Token do Telegram (via @BotFather)
- Conta na Vercel (deploy gratuito)
- Servi√ßo de cron-job (EasyCron recomendado)

### ‚ö° **Instala√ß√£o Local**

```bash
# 1. Clone o reposit√≥rio
git clone https://github.com/rafak1ngz/ZettiBot.git
cd ZettiBot

# 2. Instale as depend√™ncias
npm install

# 3. Configure as vari√°veis de ambiente
cp .env.example .env.local
# Edite o .env.local com suas chaves

# 4. Execute em desenvolvimento
npm run dev
```

### üîß **Configura√ß√£o das Vari√°veis**

```env
# Telegram Bot
TELEGRAM_BOT_TOKEN=seu_bot_token_aqui
WEBHOOK_URL=https://seu-dominio.vercel.app
WEBHOOK_SECURITY_KEY=chave_secreta_unica

# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://seu-projeto.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=sua_chave_publica
SUPABASE_SERVICE_ROLE_KEY=sua_chave_privada
```

### üöÄ **Deploy na Vercel**

```bash
# 1. Instale a CLI da Vercel
npm i -g vercel

# 2. Fa√ßa login e configure
vercel login
vercel

# 3. Configure as vari√°veis de ambiente no dashboard da Vercel

# 4. Configure o webhook do Telegram
curl -X POST "https://api.telegram.org/bot{SEU_TOKEN}/setWebhook" \
     -H "Content-Type: application/json" \
     -d '{"url": "https://seu-app.vercel.app/api/telegram/webhook"}'

# 5. Configure cron-job no EasyCron (https://www.easycron.com)
# URL: https://seu-app.vercel.app/api/notifications/process
# Frequ√™ncia: Every 1 minute
# Headers: Authorization: Bearer {WEBHOOK_SECURITY_KEY}
```

---

## üì± Como Usar

### üé¨ **Primeiros Passos**

1. **Inicie uma conversa** com seu ZettiBot no Telegram
2. **Digite `/start`** para criar sua conta
3. **Forne√ßa seu email** quando solicitado
4. **Explore o menu principal** e suas funcionalidades

### üìã **Comandos Dispon√≠veis**

| Comando | Descri√ß√£o | Status |
|---------|-----------|--------|
| `/start` ou `/inicio` | Iniciar ou criar conta | ‚úÖ |
| `/ajuda` | Lista todos os comandos | ‚úÖ |
| `/clientes` | Gerenciar base de clientes | ‚úÖ |
| `/agenda` | Organizar compromissos | ‚úÖ |
| `/cancelar` | Cancelar opera√ß√£o atual | ‚úÖ |
| `/followup` | Acompanhar leads | üîÑ |
| `/lembrete` | Criar alertas | üîÑ |

### üîÑ **Fluxos Principais**

**Adicionar Cliente:**
1. `/clientes` ‚Üí "Adicionar novo cliente"
2. Informe: Nome da empresa ‚Üí CNPJ ‚Üí Contato ‚Üí Telefone ‚Üí Email
3. Confirme os dados e salve

**Agendar Compromisso:**
1. `/agenda` ‚Üí "Novo Compromisso"
2. Escolha vincular a cliente ou n√£o
3. Defina: T√≠tulo ‚Üí Data ‚Üí Hora ‚Üí Local
4. Configure notifica√ß√£o (15min a 24h antes)
5. Confirme o agendamento

**Gerenciar Notifica√ß√µes:**
- Criadas automaticamente ao agendar compromissos
- Processadas via cron-job a cada minuto
- Retry autom√°tico em caso de falha

---

## üèóÔ∏è Arquitetura

### üìÅ **Estrutura do Projeto**

```
src/
‚îú‚îÄ‚îÄ lib/telegram/                 # Core do bot
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                 # Bot principal
‚îÇ   ‚îú‚îÄ‚îÄ middleware/              # Middlewares
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.ts             # Autentica√ß√£o + cache
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rateLimit.ts        # Prote√ß√£o anti-spam
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conversation/       # Processamento de conversas
‚îÇ   ‚îú‚îÄ‚îÄ commands/               # Comandos do bot
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ menu/              # Navega√ß√£o principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ clientes/          # CRUD de clientes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agenda/            # Gest√£o de compromissos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shared/            # Utilit√°rios compartilhados
‚îÇ   ‚îî‚îÄ‚îÄ notifications/          # Sistema de notifica√ß√µes
‚îÇ       ‚îú‚îÄ‚îÄ scheduler.ts        # Agendamento
‚îÇ       ‚îú‚îÄ‚îÄ sender.ts          # Envio via Telegram
‚îÇ       ‚îî‚îÄ‚îÄ templates.ts       # Modelos de mensagem
‚îú‚îÄ‚îÄ utils/                      # Utilit√°rios globais
‚îÇ   ‚îú‚îÄ‚îÄ timezone.ts            # Gest√£o de fuso hor√°rio
‚îÇ   ‚îú‚îÄ‚îÄ validators.ts          # Valida√ß√µes customizadas
‚îÇ   ‚îú‚îÄ‚îÄ messages.ts           # Mensagens padronizadas
‚îÇ   ‚îî‚îÄ‚îÄ audit.ts              # Logs de auditoria
‚îú‚îÄ‚îÄ types/                     # Interfaces TypeScript
‚îî‚îÄ‚îÄ pages/api/                 # Endpoints da API
    ‚îú‚îÄ‚îÄ telegram/webhook.ts    # Receptor de mensagens
    ‚îî‚îÄ‚îÄ notifications/         # Processamento de notifica√ß√µes
```

### üîÑ **Fluxo de Dados**

```mermaid
graph LR
    A[Telegram] --> B[Webhook]
    B --> C[Middleware]
    C --> D[Commands]
    D --> E[Supabase]
    E --> F[Response]
    F --> A
    
    G[Cron-Job] --> H[Process API]
    H --> I[Notifications]
    I --> J[Telegram API]
```

---

## üß™ Desenvolvimento

### üîß **Scripts Dispon√≠veis**

```bash
npm run dev          # Servidor de desenvolvimento
npm run build        # Build de produ√ß√£o  
npm run start        # Servidor de produ√ß√£o
npm run lint         # Linter ESLint
npm run type-check   # Verifica√ß√£o TypeScript
```

### üß™ **Testando Localmente**

```bash
# 1. Use ngrok para expor porta local
npx ngrok http 3000

# 2. Configure webhook tempor√°rio
curl -X POST "https://api.telegram.org/bot{TOKEN}/setWebhook" \
     -d "url=https://seu-ngrok-url.ngrok.io/api/telegram/webhook"

# 3. Teste notifica√ß√µes manualmente
curl -X POST "http://localhost:3000/api/notifications/test" \
     -H "Authorization: Bearer {WEBHOOK_SECURITY_KEY}" \
     -d '{"telegram_id": 123456789, "tipo_teste": "envio_direto"}'
```

### üîç **Debug e Logs**

- **Desenvolvimento**: Logs detalhados no console
- **Produ√ß√£o**: Vercel Dashboard para logs de runtime
- **Banco**: Supabase Dashboard para monitoramento
- **Notifica√ß√µes**: Logs timestampados com resultado de envio

---

## üîß Configura√ß√£o do Banco (Supabase)

### üìä **Tabelas Principais**

```sql
-- Usu√°rios do sistema
users (id, telegram_id, email, username, full_name, created_at, last_active)

-- Clientes cadastrados
clientes (id, user_id, nome_empresa, cnpj, contato_nome, contato_telefone, contato_email, observacoes)

-- Compromissos agendados
compromissos (id, user_id, cliente_id, titulo, descricao, data_compromisso, local, status)

-- Notifica√ß√µes autom√°ticas
notificacoes (id, user_id, telegram_id, tipo, titulo, mensagem, agendado_para, status, tentativas)

-- Sess√µes de conversa
sessions (id, telegram_id, user_id, command, step, data, updated_at)

-- Logs de auditoria
audit_logs (id, user_id, telegram_id, acao, detalhes, timestamp)
```

---

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Por favor:

1. **Fork** o projeto
2. **Crie uma branch** para sua feature (`git checkout -b feature/NovaFuncionalidade`)
3. **Commit** suas mudan√ßas (`git commit -m 'Adiciona nova funcionalidade X'`)
4. **Push** para a branch (`git push origin feature/NovaFuncionalidade`)
5. **Abra um Pull Request**

### üìã **Diretrizes de Contribui√ß√£o**

- Siga os padr√µes de c√≥digo TypeScript
- Mantenha a arquitetura modular existente
- Adicione logs de auditoria para a√ß√µes importantes
- Use utilit√°rios de timezone para datas
- Documente novas funcionalidades
- Siga os padr√µes de commit convencionais

---

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para detalhes.

---

## üìû Suporte

- üìß **Email**: contato@zettibot.com
- üí¨ **Telegram**: @ZettiBotSupport  
- üêõ **Issues**: [GitHub Issues](https://github.com/rafak1ngz/ZettiBot/issues)
- üìñ **Documenta√ß√£o**: [Changelog](CHANGELOG.md)

---

## üéØ Roadmap

### ‚úÖ **v1.0.0 - LAN√áADO (20/07/2025)**

- ‚úÖ Sistema de usu√°rios e autentica√ß√£o
- ‚úÖ CRUD completo de clientes
- ‚úÖ Sistema de agenda completo
- ‚úÖ Notifica√ß√µes autom√°ticas
- ‚úÖ Arquitetura modular robusta
- ‚úÖ Gest√£o de fuso hor√°rio brasileiro
- ‚úÖ Valida√ß√µes e tratamento de erros

### üîÑ **v1.1.0 - EM PLANEJAMENTO**

- üîÑ Follow-up de leads com pipeline
- üîÑ Lembretes personalizados
- üîÑ Relat√≥rios b√°sicos de vendas
- üîÑ API p√∫blica para integra√ß√µes

### üîÆ **v2.0.0 - FUTURO**

- üîÆ Dashboard web administrativo
- üîÆ Otimiza√ß√£o de rotas com maps
- üîÆ App mobile nativo
- üîÆ Intelig√™ncia artificial para insights
- üîÆ Integra√ß√£o com CRMs externos

---

## üèÜ Status de Qualidade

| M√©trica | Status | Descri√ß√£o |
|---------|--------|-----------|
| Funcionalidade | üü¢ 100% | Core features implementadas |
| Estabilidade | üü¢ 99.9% | Sistema robusto em produ√ß√£o |
| Performance | üü¢ Otimizada | Cache e queries otimizadas |
| Seguran√ßa | üü¢ Robusta | Rate limiting e valida√ß√µes |
| Manutenibilidade | üü¢ Excelente | C√≥digo modular e documentado |

---

## üôè Agradecimentos

- **Equipe Telegram** pela excelente Bot API
- **Vercel** pela plataforma de deploy gratuita
- **Supabase** pelo backend completo e confi√°vel
- **Claude (Anthropic)** pela parceria incans√°vel no desenvolvimento
- **Comunidade Open Source** pelas bibliotecas incr√≠veis

---

<div align="center">

**Desenvolvido com ‚ù§Ô∏è por [Rafael Dantas](https://github.com/rafak1ngz)**

**ZettiBot v1.0.0** - *Transformando caos em estrat√©gia desde 2025*

[‚≠ê Star no GitHub](https://github.com/rafak1ngz/ZettiBot) ‚Ä¢ [üêõ Reportar Bug](https://github.com/rafak1ngz/ZettiBot/issues) ‚Ä¢ [üí° Sugerir Feature](https://github.com/rafak1ngz/ZettiBot/issues) ‚Ä¢ [üìã Changelog](CHANGELOG.md)

</div>